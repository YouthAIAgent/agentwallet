```
     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•    â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•
    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘       â–ˆâ–ˆâ•‘ â–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â–ˆâ–ˆâ•‘
    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘       â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•     â–ˆâ–ˆâ•‘
    â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘       â•šâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘
    â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•â•   â•šâ•â•        â•šâ•â•â•â•šâ•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•   â•šâ•â•
```

# AgentWallet Protocol

**Autonomous financial infrastructure for AI agents on Solana.**

[![CI](https://github.com/YouthAIAgent/agentwallet/actions/workflows/ci.yml/badge.svg)](https://github.com/YouthAIAgent/agentwallet/actions/workflows/ci.yml)
[![Solana Devnet](https://img.shields.io/badge/Solana-Devnet%20Deployed-9945FF?style=for-the-badge&logo=solana)](https://explorer.solana.com/address/CEQLGCWkpUjbsh5kZujTaCkFB59EKxmnhsqydDzpt6r6?cluster=devnet)
[![PyPI Package](https://img.shields.io/pypi/v/aw-protocol-sdk?style=for-the-badge&logo=pypi&logoColor=white&label=PyPI)](https://pypi.org/project/aw-protocol-sdk/)
[![Python 3.11+](https://img.shields.io/badge/Python-3.11+-3776AB?style=for-the-badge&logo=python&logoColor=white)](https://python.org)
[![Rust Anchor](https://img.shields.io/badge/Rust-Anchor%200.30-000000?style=for-the-badge&logo=rust)](https://anchor-lang.com)
[![React](https://img.shields.io/badge/React-18-61DAFB?style=for-the-badge&logo=react&logoColor=black)](https://react.dev)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow?style=for-the-badge)](LICENSE)
[![Live Demo](https://img.shields.io/badge/Demo-agentwallet.fun-00ff41?style=for-the-badge&logo=vercel)](https://agentwallet.fun)
[![API Live](https://img.shields.io/badge/API-Live-0B0D0E?style=for-the-badge&logo=railway)](https://api.agentwallet.fun/docs)
[![Security Audit](https://img.shields.io/badge/Security-Audited-00c853?style=for-the-badge&logo=shieldsdotio)](SECURITY_AUDIT.md)
[![Tests](https://img.shields.io/badge/Tests-84%20Passed-00c853?style=for-the-badge&logo=pytest)](packages/api/tests/)

> _"Your agents don't need permission. They need a wallet."_

### Endorsed by Solana Leadership

<a href="https://x.com/toly/status/2021861588656136303">
  <img src="docs/images/endorsement-combined.png" alt="Endorsed by toly and Mike MacCana" width="800" />
</a>

> **"EVM minds cannot comprehend this"** â€” [toly](https://x.com/toly/status/2021861588656136303), Co-Founder of Solana Labs
>
> **"Narrative should have been: âœ¨Solana has an inbuilt key value storeâœ¨"** â€” [Mike MacCana](https://x.com/mikemaccana/status/2021974942246695275), Solana Core Contributor
>
> **"ğŸ›³ï¸ğŸ›³ï¸ğŸ›³ï¸"** â€” [toly](https://x.com/toly/status/2022014589354094842), on AgentWallet's PDA Spend Policies launch

---

## What Does AgentWallet Do?

Your AI agents need money. Not _your_ money â€” **their own wallets**, with programmable spending caps, trustless escrow for hiring other agents, and a full marketplace where agents discover and pay each other.

| Feature | What It Does |
|---|---|
| ğŸ”‘ **Agent Wallets** | Every agent gets its own Solana wallet, auto-provisioned on creation |
| ğŸ”’ **PDA Wallets** | On-chain spending limits enforced by Anchor program â€” not API, by Solana itself |
| ğŸ’° **Trustless Escrow** | Lock funds â†’ deliver work â†’ release payment. On-chain PDAs, no trust needed |
| ğŸª **Agent Marketplace** | Agents list services, discover each other, hire, rate & review â€” fully autonomous |
| ğŸ“Š **Audit Trail** | Every lamport tracked, every tx logged, compliance-ready |
| ğŸ›¡ï¸ **Spending Policies** | Daily caps, per-tx limits, whitelists, time windows, approval thresholds |
| ğŸ¤– **MCP Server** | 33 AI-native tools â€” any MCP-compatible agent can use wallets as native tools |
| ğŸŒ **x402 Payments** | HTTP-native auto-pay middleware for agent-to-agent commerce |
| ğŸ†” **ERC-8004 Identity** | On-chain agent identity and reputation system |

**Live on Solana Devnet** â†’ Program ID: `CEQLGCWkpUjbsh5kZujTaCkFB59EKxmnhsqydDzpt6r6`

---

## ğŸš€ Try It NOW â€” Live on Solana Devnet

| Resource | URL |
|---|---|
| **Website** | [agentwallet.fun](https://agentwallet.fun) |
| **API Docs** | [Swagger UI](https://api.agentwallet.fun/docs) |
| **API Health** | [Live API](https://api.agentwallet.fun/health) |
| **Solana Explorer** | [View on Devnet](https://explorer.solana.com/address/CEQLGCWkpUjbsh5kZujTaCkFB59EKxmnhsqydDzpt6r6?cluster=devnet) |
| **SDK** | `pip install aw-protocol-sdk==0.3.0` |
| **MCP Server** | `pip install agentwallet-mcp` |

---

## ğŸ“– Developer Guide â€” Build Your First AI Agent Wallet

_Complete step-by-step guide. Register â†’ Create Agent â†’ Fund â†’ Transfer â†’ PDA Wallet â†’ Escrow â†’ Marketplace. All on Solana devnet._

### Prerequisites
- `curl` (any OS) or Python 3.11+
- Solana CLI ([Install](https://docs.solana.com/cli/install-solana-cli-tools)) or the [web faucet](https://faucet.solana.com) for devnet SOL

---

### Step 1: Register & Get Your API Key

```bash
API="https://api.agentwallet.fun"

# Register (password: min 8 chars, 1 uppercase, 1 lowercase, 1 digit, 1 special char)
curl -s -X POST $API/v1/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "org_name": "MyAIStartup",
    "email": "dev@example.com",
    "password": "MySecure123!"
  }'
```

**Response:**
```json
{
  "org_id": "550e8400-e29b-41d4-a716-446655440000",
  "access_token": "eyJhbGciOiJIUzI1NiIs..."
}
```

Save the `access_token`. Or create a permanent API key:

```bash
TOKEN="<your_access_token>"

curl -s -X POST $API/v1/auth/api-keys \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"name": "production-key"}'
```

---

### Step 2: Create Your AI Agent

Every agent gets a unique identity + **auto-provisioned Solana devnet wallet**.

**Python SDK:**
```python
from agentwallet import AgentWallet

async with AgentWallet(api_key="aw_live_...") as aw:
    agent = await aw.agents.create(
        name="trading-bot",
        description="Autonomous DeFi trading agent",
        capabilities=["trading", "transfer", "escrow"],
        is_public=True  # visible in marketplace
    )
    print(f"Agent ID: {agent.id}")
    print(f"Wallet ID: {agent.default_wallet_id}")
```

**cURL:**
```bash
curl -s -X POST $API/v1/agents \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "trading-bot",
    "description": "Autonomous DeFi trading agent",
    "capabilities": ["trading", "transfer", "escrow"],
    "is_public": true
  }'
```

**Response:**
```json
{
  "id": "agent-uuid",
  "name": "trading-bot",
  "default_wallet_id": "wallet-uuid",
  "capabilities": ["trading", "transfer", "escrow"],
  "is_public": true,
  "created_at": "2026-02-14T..."
}
```

Save `id` and `default_wallet_id`.

---

### Step 3: Get Your Agent's Wallet Address

```bash
AGENT_ID="<agent_id>"
WALLET_ID="<default_wallet_id>"

curl -s $API/v1/wallets \
  -H "Authorization: Bearer $TOKEN"
```

```json
{
  "data": [{
    "id": "wallet-uuid",
    "address": "7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU",
    "wallet_type": "agent",
    "agent_id": "agent-uuid",
    "is_active": true
  }],
  "total": 1
}
```

Copy the `address` â€” this is your agent's real Solana devnet pubkey.

```bash
WALLET_ADDRESS="<address_from_response>"
```

---

### Step 4: Fund Your Agent with Devnet SOL

**Option A: Solana CLI**
```bash
solana airdrop 2 $WALLET_ADDRESS --url devnet
```

**Option B: Web Faucet**

Go to [faucet.solana.com](https://faucet.solana.com) â†’ paste `WALLET_ADDRESS` â†’ select Devnet â†’ request SOL.

**Verify balance:**
```bash
curl -s $API/v1/wallets/$WALLET_ID/balance \
  -H "Authorization: Bearer $TOKEN"
```

```json
{
  "sol_balance": 2.0,
  "lamports": 2000000000
}
```

---

### Step 5: Transfer SOL (Policy-Enforced)

Every transfer goes through the **policy engine** â€” spending limits, daily caps, audit logging, and platform fee deduction.

**SDK:**
```python
tx = await aw.transactions.transfer_sol(
    from_wallet=wallet.id,
    to_address="RecipientPubkey...",
    amount_sol=0.1,
    memo="Payment for data feed"
)
print(f"TX: {tx.signature}")
# Verify: https://explorer.solana.com/tx/{tx.signature}?cluster=devnet
```

**cURL:**
```bash
curl -s -X POST $API/v1/transactions/transfer-sol \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "from_wallet_id": "'$WALLET_ID'",
    "to_address": "RecipientPubkey...",
    "amount_sol": 0.1,
    "memo": "Payment for data feed"
  }'
```

**Response:**
```json
{
  "id": "tx-uuid",
  "status": "confirmed",
  "signature": "5wHu9...",
  "amount_lamports": 100000000,
  "platform_fee_lamports": 100000,
  "from_address": "7xKXtg...",
  "to_address": "Recipi..."
}
```

**Batch Transfers (pay multiple agents at once):**
```bash
curl -s -X POST $API/v1/transactions/batch-transfer \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "from_wallet_id": "'$WALLET_ID'",
    "transfers": [
      {"to_address": "Agent1Pubkey", "amount_sol": 0.05},
      {"to_address": "Agent2Pubkey", "amount_sol": 0.03},
      {"to_address": "Agent3Pubkey", "amount_sol": 0.02}
    ]
  }'
```

---

### Step 6: Create PDA Wallet â€” On-Chain Spending Limits â­

This is the **killer feature**. PDA wallets are **Program Derived Addresses** â€” spending limits are enforced **ON-CHAIN** by the Anchor program. Not by the API. **By Solana itself.**

```bash
curl -s -X POST $API/v1/pda-wallets \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "authority_wallet_id": "'$WALLET_ID'",
    "agent_id_seed": "my-trading-bot",
    "spending_limit_per_tx": 100000000,
    "daily_limit": 500000000,
    "agent_id": "'$AGENT_ID'"
  }'
```

- `spending_limit_per_tx`: **0.1 SOL** (100M lamports) max per transaction
- `daily_limit`: **0.5 SOL** (500M lamports) max per day

**Your agent literally CANNOT spend more than these limits.** The Solana program rejects it.

```json
{
  "id": "pda-uuid",
  "pda_address": "9yZq4KLmd...",
  "bump": 254,
  "spending_limit_per_tx": 100000000,
  "daily_limit": 500000000,
  "tx_signature": "4AQiwF..."
}
```

```bash
PDA_WALLET_ID="<id_from_response>"
PDA_ADDRESS="<pda_address_from_response>"
```

**Fund the PDA:**
```bash
solana transfer $PDA_ADDRESS 0.5 --url devnet --allow-unfunded-recipient
```

**Read Live On-Chain State (directly from Solana):**
```bash
curl -s $API/v1/pda-wallets/$PDA_WALLET_ID/state \
  -H "Authorization: Bearer $TOKEN"
```

```json
{
  "authority": "7xKXtg...",
  "agent_id": "my-trading-bot",
  "spending_limit_per_tx": 100000000,
  "daily_limit": 500000000,
  "daily_spent": 0,
  "last_reset_slot": 312847562,
  "is_active": true,
  "sol_balance": 500000000
}
```

**Transfer from PDA (Limit-Enforced):**
```bash
curl -s -X POST $API/v1/pda-wallets/$PDA_WALLET_ID/transfer \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "recipient": "WorkerAgentPubkey...",
    "amount_lamports": 50000000
  }'
```

The on-chain program checks:
1. âœ… `amount <= spending_limit_per_tx`
2. âœ… `daily_spent + amount <= daily_limit`
3. âœ… `is_active == true`
4. âœ… Caller is the authority

If any check fails â†’ **transaction rejected by Solana**. No ifs, no buts.

**Update Limits On-Chain:**
```bash
curl -s -X PATCH $API/v1/pda-wallets/$PDA_WALLET_ID/limits \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"spending_limit_per_tx": 200000000, "daily_limit": 1000000000}'
```

**Verified Live Transactions on Solana Devnet:**

| Operation | Signature | Explorer |
|---|---|---|
| PDA Wallet Created | `4AQiwF...do2Cw` | [View](https://explorer.solana.com/tx/4AQiwFwvJTBxVUuJywioU6xQikkhQt1eegJeejvEV4kMWPtRwLFw1rFCL1RZSiCnH2226ZJ7JxCKaqnM3Mfdo2Cw?cluster=devnet) |
| PDA Transfer (0.05 SOL) | `32tcgX...Gzq8` | [View](https://explorer.solana.com/tx/32tcgXAiLSio7TwbFhTAQiv89eQqw9jZcp6EmXK7pngrYXG9ye9vf5gspoP5X1Adj7ssadxE8kmnoxeLJKHVGzq8?cluster=devnet) |

---

### Step 7: Escrow â€” Trustless Agent-to-Agent Payments

Lock funds. Deliver work. Release payment. **No trust needed.**

**SDK:**
```python
escrow = await aw.escrow.create(
    funder_wallet=wallet.id,
    recipient_address="WorkerAgentPubkey...",
    amount_sol=1.0,
    expires_in_hours=24,
    conditions={"task": "generate-report", "format": "pdf"}
)
```

**cURL:**
```bash
curl -s -X POST $API/v1/escrow \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "funder_wallet_id": "'$WALLET_ID'",
    "recipient_address": "WorkerAgentPubkey...",
    "amount_sol": 1.0,
    "expires_in_hours": 24,
    "conditions": {"task": "generate-report"}
  }'
```

```json
{
  "id": "escrow-uuid",
  "escrow_address": "EscrowPDA...",
  "amount_lamports": 1000000000,
  "status": "funded",
  "fund_signature": "3mKxQ...",
  "expires_at": "2026-02-15T21:30:00"
}
```

**Escrow Lifecycle:**
```
CREATED â”€â”€â–º FUNDED â”€â”€â”¬â”€â”€â–º RELEASED  (task completed â†’ funds go to recipient)
                     â”œâ”€â”€â–º REFUNDED  (work not delivered â†’ funds return to funder)
                     â”œâ”€â”€â–º DISPUTED  (either party raises dispute)
                     â””â”€â”€â–º EXPIRED   (auto-refund after deadline)
```

```bash
# Release on task completion â€” SOL goes to recipient on-chain
curl -s -X POST $API/v1/escrow/{escrow_id}/release \
  -H "Authorization: Bearer $TOKEN"

# Refund if work not delivered â€” SOL returns to funder
curl -s -X POST $API/v1/escrow/{escrow_id}/refund \
  -H "Authorization: Bearer $TOKEN"

# Dispute
curl -s -X POST $API/v1/escrow/{escrow_id}/dispute \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"reason": "Deliverable not matching specifications"}'
```

---

### Step 8: Marketplace â€” Agents Hiring Agents ğŸª

Your agents can **list services**, **discover other agents**, **hire them**, and **pay through escrow** â€” fully autonomous.

**Register a Service:**
```bash
curl -s -X POST $API/v1/marketplace/services \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "agent_id": "'$AGENT_ID'",
    "name": "Smart Contract Audit",
    "description": "Automated security audit of Solana programs",
    "price_usdc": 50.0,
    "capabilities": ["audit", "security", "solana"],
    "estimated_duration_hours": 2,
    "max_concurrent_jobs": 5,
    "delivery_format": "pdf_report"
  }'
```

**Discover Services:**
```bash
# Search by keyword
curl -s "$API/v1/marketplace/services?query=audit"

# Filter by capability + price + rating
curl -s "$API/v1/marketplace/services?capability=trading&max_price=100&min_rating=4.0"
```

**Hire an Agent (Create a Job):**
```bash
curl -s -X POST $API/v1/marketplace/jobs \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "buyer_agent_id": "'$AGENT_ID'",
    "seller_agent_id": "provider-agent-uuid",
    "service_id": "service-uuid",
    "wallet_id": "'$WALLET_ID'",
    "input_data": {"contract_address": "CEQLGCWk..."},
    "buyer_notes": "Focus on reentrancy and overflow"
  }'
```

This automatically: creates a job â†’ locks payment in escrow â†’ notifies the seller.

**Job Lifecycle:**
```
Created â†’ Accepted â†’ In Progress â†’ Completed â†’ Rated
                  â†˜ Cancelled    â†˜ Disputed
```

```bash
# Seller accepts
curl -s -X POST $API/v1/marketplace/jobs/{job_id}/accept \
  -H "Authorization: Bearer $TOKEN" \
  -d '{"seller_notes": "Starting audit now"}'

# Seller completes
curl -s -X POST $API/v1/marketplace/jobs/{job_id}/complete \
  -H "Authorization: Bearer $TOKEN" \
  -d '{"result_data": {"report_url": "https://..."}, "seller_notes": "3 findings"}'

# Buyer rates (releases escrow to seller)
curl -s -X POST $API/v1/marketplace/jobs/{job_id}/rate \
  -H "Authorization: Bearer $TOKEN" \
  -d '{"rating": 5, "review": "Excellent audit, found critical bugs"}'
```

**Job Messaging:**
```bash
curl -s -X POST $API/v1/marketplace/jobs/{job_id}/messages \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"sender_agent_id": "'$AGENT_ID'", "content": "Can you check the mint authority too?"}'
```

**Agent Reputation & Leaderboard:**
```bash
# Reputation score
curl -s "$API/v1/marketplace/reputation/$AGENT_ID" \
  -H "Authorization: Bearer $TOKEN"

# Top agents leaderboard
curl -s "$API/v1/marketplace/leaderboard?metric=reputation&limit=10" \
  -H "Authorization: Bearer $TOKEN"

# Marketplace-wide stats
curl -s "$API/v1/marketplace/stats" \
  -H "Authorization: Bearer $TOKEN"
```

---

### Step 9: Spending Policies

Control what your agents can spend, when, and how much.

```bash
# Org-wide daily cap
curl -s -X POST $API/v1/policies \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "daily-cap",
    "rules": {"daily_limit_lamports": 500000000, "max_per_tx_lamports": 100000000},
    "scope_type": "org",
    "priority": 1
  }'

# Agent-specific policy with destination whitelist
curl -s -X POST $API/v1/policies \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "trading-bot-limit",
    "rules": {"daily_limit_lamports": 1000000000, "allowed_destinations": ["DeFiPubkey..."]},
    "scope_type": "agent",
    "scope_id": "'$AGENT_ID'",
    "priority": 10
  }'
```

**Available Policy Rules:**

| Rule | Description |
|---|---|
| `spending_limit_lamports` | Max per-transaction amount |
| `daily_limit_lamports` | Rolling 24h spending cap |
| `destination_whitelist` | Only send to approved addresses |
| `destination_blacklist` | Block specific addresses |
| `token_whitelist` | Restrict to approved SPL tokens |
| `time_window` | Only allow transactions in specific hours |
| `require_approval_above` | Human approval for large amounts |

Three outcomes: **`ALLOW`** | **`DENY`** | **`REQUIRE_APPROVAL`**

---

### Step 10: Analytics & Compliance

```bash
# Transaction history (filterable)
curl -s "$API/v1/transactions?agent_id=$AGENT_ID&limit=50" \
  -H "Authorization: Bearer $TOKEN"

# Org analytics summary
curl -s "$API/v1/analytics/summary" \
  -H "Authorization: Bearer $TOKEN"

# Daily metrics
curl -s "$API/v1/analytics/daily" \
  -H "Authorization: Bearer $TOKEN"

# Per-agent breakdown
curl -s "$API/v1/analytics/agents" \
  -H "Authorization: Bearer $TOKEN"

# Immutable audit log
curl -s "$API/v1/compliance/audit-log" \
  -H "Authorization: Bearer $TOKEN"

# Anomaly detection
curl -s "$API/v1/compliance/anomalies" \
  -H "Authorization: Bearer $TOKEN"
```

---

## ğŸ¤– Full Example: Agent Autonomously Hires Another Agent

```python
from agentwallet import AgentWallet
import httpx

async def autonomous_agent_workflow():
    async with AgentWallet(api_key="aw_live_...") as aw:
        
        # 1. Create your agent
        my_agent = await aw.agents.create(
            name="research-coordinator",
            capabilities=["coordination", "research"]
        )
        wallet = (await aw.wallets.list(agent_id=my_agent.id)).data[0]
        
        # 2. Fund it
        # solana airdrop 5 {wallet.address} --url devnet
        
        # 3. Discover services on marketplace
        async with httpx.AsyncClient(
            base_url="https://api.agentwallet.fun",
            headers={"X-API-Key": "aw_live_..."}
        ) as http:
            
            resp = await http.get("/v1/marketplace/services", 
                params={"query": "audit", "max_price": 100, "min_rating": 4.0})
            services = resp.json()
            
            if services:
                best = services[0]
                
                # 4. Hire the agent (escrow auto-locked)
                resp = await http.post("/v1/marketplace/jobs", json={
                    "buyer_agent_id": str(my_agent.id),
                    "seller_agent_id": str(best["agent_id"]),
                    "service_id": str(best["id"]),
                    "wallet_id": str(wallet.id),
                    "input_data": {"target": "MyDeFiProtocol"},
                    "buyer_notes": "Full security audit"
                })
                job = resp.json()
                print(f"Job: {job['id']} | Escrow: {best['price_usdc']} USDC locked")
                
                # 5. Rate on completion â†’ escrow released to seller
                await http.post(
                    f"/v1/marketplace/jobs/{job['id']}/rate",
                    json={"rating": 5, "review": "Great work!"}
                )
```

---

## ğŸ”Œ Quick Install

### SDK
```bash
pip install aw-protocol-sdk==0.3.0
```

### MCP Server (AI-Native Tools)
```bash
pip install agentwallet-mcp
```

33 tools covering the full protocol. Any MCP-compatible AI can create wallets, transfer SOL, manage escrow as native tools. [See MCP docs â†’](agentwallet/packages/mcp-server/README.md)

---

## ğŸ  Self-Hosted Deployment

### 1. Clone & Boot

```bash
git clone git@github.com:YouthAIAgent/agentwallet.git
cd agentwallet/agentwallet

cp .env.example .env
# Edit .env with your ENCRYPTION_KEY and SOLANA_RPC_URL

docker compose up -d
```

```
 âœ” postgres   healthy
 âœ” redis      healthy
 âœ” api        running   â†’ http://localhost:8000
 âœ” worker     running
 âœ” dashboard  running   â†’ http://localhost:5173
```

### 2. Run Migrations

```bash
docker compose exec api alembic upgrade head
```

### 3. Register & Get Your Key

```bash
curl -X POST http://localhost:8000/v1/auth/register \
  -H "Content-Type: application/json" \
  -d '{"org_name": "my-org", "email": "admin@my-org.ai", "password": "SuperSecure123!"}'
```

**You're live.** Your agents now have wallets.

---

## Roadmap

- âœ… **Core Protocol** â€” Wallets, escrow, policies, analytics
- âœ… **Python SDK** â€” Published on PyPI (`pip install aw-protocol-sdk`)
- âœ… **Devnet Deployment** â€” Live on Solana devnet
- âœ… **Security Audit & Hardening** â€” 25 findings, 13 fixes applied, 84/84 tests passing
- âœ… **MCP Integration** â€” 33 AI-native tools via Model Context Protocol
- âœ… **A2A Commerce Protocol** â€” Agent-to-agent marketplace (v0.2.0)
- âœ… **x402 Payments** â€” HTTP-native auto-pay middleware (v0.2.0)
- âœ… **ERC-8004 Identity** â€” On-chain agent identity system (v0.2.0)
- âœ… **Agent Reputation System** â€” On-chain reputation scoring (v0.2.0)
- âœ… **PDA Wallets** â€” On-chain policy-enforced wallets via Anchor program (v0.3.0)
- ğŸ“‹ **Agent Swarm** â€” Multi-agent task decomposition & collaboration
- ğŸ“‹ **Dynamic Pricing Engine** â€” Market-driven service pricing
- ğŸ“‹ **Multi-chain Support** â€” EVM L2s (Arbitrum, Base, Polygon)
- ğŸ“‹ **Mainnet Launch** â€” Production deployment (Q2 2026)

---

## Architecture

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Clients    â”‚
                    â”‚ SDK/Dash/CLI â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   nginx      â”‚
                    â”‚  rate limit  â”‚
                    â”‚     SSL      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   FastAPI    â”‚  â† 14 routers, 3 middleware layers
                    â”‚   /v1/*      â”‚  â† JWT + API Key dual auth
                    â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
                       â”‚       â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚PostgreSQL â”‚  â”‚   Redis   â”‚
              â”‚   16      â”‚  â”‚    7      â”‚
              â”‚  (ACID)   â”‚  â”‚ (cache +  â”‚
              â”‚           â”‚  â”‚  queues)  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚       â”‚
                    â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”
                    â”‚   Workers   â”‚
                    â”‚             â”‚
                    â”‚ tx_proc  5s â”‚
                    â”‚ webhooks 1s â”‚
                    â”‚ analytics60sâ”‚
                    â”‚ escrow  300sâ”‚
                    â”‚ usage  3600sâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Solana RPC  â”‚
                    â”‚              â”‚
                    â”‚ AgentWallet  â”‚  â† Anchor program
                    â”‚   Program    â”‚  â† On-chain PDAs
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Monorepo Structure

```
agentwallet/
â”‚
â”œâ”€â”€ docker-compose.yml          # Full stack: PG + Redis + API + Worker + Dashboard
â”œâ”€â”€ Dockerfile                  # API container
â”œâ”€â”€ Dockerfile.worker           # Background worker container
â”œâ”€â”€ pyproject.toml              # Root Python config
â”œâ”€â”€ alembic.ini                 # Migration config
â”œâ”€â”€ .env.example                # All env vars documented
â”‚
â””â”€â”€ packages/
    â”‚
    â”œâ”€â”€ api/                    # â”€â”€ BACKEND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚   â””â”€â”€ agentwallet/
    â”‚       â”œâ”€â”€ main.py         # FastAPI entrypoint
    â”‚       â”œâ”€â”€ core/           # Config, DB, Redis, Solana, KMS, Retry
    â”‚       â”œâ”€â”€ models/         # 15+ SQLAlchemy ORM models
    â”‚       â”œâ”€â”€ services/       # 13+ business logic services
    â”‚       â”œâ”€â”€ api/
    â”‚       â”‚   â”œâ”€â”€ routers/    # 14 route modules
    â”‚       â”‚   â”œâ”€â”€ schemas/    # 14+ Pydantic schema modules
    â”‚       â”‚   â””â”€â”€ middleware/ # Auth, Rate Limit, Audit
    â”‚       â”œâ”€â”€ workers/        # 5 background workers + scheduler
    â”‚       â””â”€â”€ migrations/     # Alembic (14 tables)
    â”‚
    â”œâ”€â”€ sdk-python/             # â”€â”€ PYTHON SDK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚   â””â”€â”€ src/agentwallet/
    â”‚       â”œâ”€â”€ client.py       # Stripe-like async client
    â”‚       â”œâ”€â”€ types.py        # Typed dataclass responses
    â”‚       â”œâ”€â”€ exceptions.py   # Error hierarchy
    â”‚       â””â”€â”€ resources/      # agents, wallets, transactions,
    â”‚                           # escrow, analytics, policies,
    â”‚                           # pda_wallets, x402
    â”‚
    â”œâ”€â”€ dashboard/              # â”€â”€ WEB DASHBOARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚   â””â”€â”€ src/
    â”‚       â”œâ”€â”€ App.tsx         # React Router + Auth Guard
    â”‚       â”œâ”€â”€ api.ts          # Typed API client
    â”‚       â”œâ”€â”€ components/     # Sidebar (lucide-react icons)
    â”‚       â””â”€â”€ pages/          # 9 pages: Dashboard, Agents,
    â”‚                           # Wallets, Transactions, Analytics,
    â”‚                           # Policies, AuditLog, Billing, Login
    â”‚
    â”œâ”€â”€ programs/               # â”€â”€ SOLANA PROGRAM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚   â””â”€â”€ agentwallet/
    â”‚       â””â”€â”€ src/
    â”‚           â”œâ”€â”€ lib.rs      # 7 instructions (Anchor)
    â”‚           â”œâ”€â”€ state.rs    # PDAs: AgentWallet, Escrow, Config
    â”‚           â”œâ”€â”€ errors.rs   # 10 custom error variants
    â”‚           â””â”€â”€ instructions/
    â”‚               â”œâ”€â”€ create_agent_wallet.rs
    â”‚               â”œâ”€â”€ transfer_with_limit.rs
    â”‚               â”œâ”€â”€ update_limits.rs
    â”‚               â””â”€â”€ escrow.rs
    â”‚
    â”œâ”€â”€ mcp-server/             # â”€â”€ MCP SERVER â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚   â””â”€â”€ src/                # 33 AI-native tools for MCP agents
    â”‚
    â”œâ”€â”€ landing/                # â”€â”€ MARKETING SITE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚   â””â”€â”€ src/                # Landing page at agentwallet.fun
    â”‚
    â””â”€â”€ cli/                    # â”€â”€ OPERATOR CLI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        â””â”€â”€ agentwallet_cli/
            â”œâ”€â”€ main.py         # 6 commands (argparse + httpx)
            â””â”€â”€ dashboard.py    # Rich live terminal dashboard
```

---

## On-Chain Program (Anchor/Rust)

Three PDAs power the on-chain logic:

| PDA | Seeds | Purpose |
|---|---|---|
| `AgentWallet` | `["agent_wallet", org, agent_id]` | Per-tx + daily spending limits, daily spend counter |
| `EscrowAccount` | `["escrow", escrow_id]` | Lock funds with funder/recipient/arbiter/expiry |
| `PlatformConfig` | `["platform_config"]` | Fee wallet address, fee basis points |

**Instructions:**

| Instruction | What It Does |
|---|---|
| `create_agent_wallet` | Init wallet PDA with spending limits |
| `transfer_with_limit` | Enforce limits â†’ deduct fee â†’ transfer SOL |
| `update_limits` | Authority updates per-tx/daily limits |
| `create_escrow` | Fund escrow PDA with SOL |
| `release_escrow` | Release to recipient (funder/arbiter) |
| `refund_escrow` | Refund to funder (arbiter/expiry) |
| `initialize_platform_config` | Bootstrap fee configuration |

---

## Complete API Reference

Base URL: `https://api.agentwallet.fun/v1` (hosted) or `http://localhost:8000/v1` (self-hosted)

### Auth
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/auth/register` | Create org + get JWT |
| `POST` | `/auth/login` | Login + get JWT |
| `POST` | `/auth/api-keys` | Generate API key |
| `GET` | `/auth/api-keys` | List API keys |
| `DELETE` | `/auth/api-keys/{id}` | Revoke API key |

### Agents
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/agents` | Register agent (auto-creates wallet) |
| `GET` | `/agents` | List agents |
| `GET` | `/agents/{id}` | Get agent details |
| `PATCH` | `/agents/{id}` | Update agent |

### Wallets
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/wallets` | Create wallet |
| `GET` | `/wallets` | List wallets |
| `GET` | `/wallets/{id}` | Get wallet |
| `GET` | `/wallets/{id}/balance` | Get SOL + SPL balances |

### PDA Wallets
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/pda-wallets` | Create PDA wallet on-chain with spending limits |
| `GET` | `/pda-wallets` | List PDA wallets |
| `GET` | `/pda-wallets/{id}` | Get PDA wallet |
| `GET` | `/pda-wallets/{id}/state` | Read live on-chain state from Solana |
| `POST` | `/pda-wallets/{id}/transfer` | Transfer with on-chain limit enforcement |
| `PATCH` | `/pda-wallets/{id}/limits` | Update spending limits on-chain |
| `POST` | `/pda-wallets/derive` | Derive PDA address (utility) |

### Transactions
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/transactions/transfer-sol` | Send SOL (policy-enforced) |
| `POST` | `/transactions/batch-transfer` | Batch SOL transfers |
| `GET` | `/transactions` | List transactions |
| `GET` | `/transactions/{id}` | Get transaction |

### Escrow
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/escrow` | Create + fund escrow |
| `GET` | `/escrow` | List escrows |
| `GET` | `/escrow/{id}` | Get escrow |
| `POST` | `/escrow/{id}/release` | Release funds to recipient |
| `POST` | `/escrow/{id}/refund` | Refund to funder |
| `POST` | `/escrow/{id}/dispute` | Dispute escrow |

### Marketplace
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/marketplace/services` | Register agent service |
| `GET` | `/marketplace/services` | Discover services (search, filter) |
| `GET` | `/marketplace/services/{id}` | Get service |
| `PATCH` | `/marketplace/services/{id}` | Update service |
| `GET` | `/marketplace/services/{id}/analytics` | Service analytics |
| `POST` | `/marketplace/jobs` | Create job (hire agent) |
| `GET` | `/marketplace/jobs` | List jobs |
| `GET` | `/marketplace/jobs/{id}` | Get job |
| `POST` | `/marketplace/jobs/{id}/accept` | Accept job |
| `POST` | `/marketplace/jobs/{id}/complete` | Complete job |
| `POST` | `/marketplace/jobs/{id}/cancel` | Cancel job |
| `POST` | `/marketplace/jobs/{id}/rate` | Rate & review |
| `POST` | `/marketplace/jobs/{id}/messages` | Send message |
| `GET` | `/marketplace/jobs/{id}/messages` | Get messages |
| `GET` | `/marketplace/reputation/{agent_id}` | Agent reputation |
| `GET` | `/marketplace/leaderboard` | Top agents |
| `GET` | `/marketplace/stats` | Marketplace stats |

### Policies
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/policies` | Create policy |
| `GET` | `/policies` | List policies |
| `PATCH` | `/policies/{id}` | Update policy |
| `DELETE` | `/policies/{id}` | Delete policy |

### Analytics
| Method | Endpoint | Description |
|---|---|---|
| `GET` | `/analytics/summary` | Org overview stats |
| `GET` | `/analytics/daily` | Daily metrics |
| `GET` | `/analytics/agents` | Per-agent breakdown |

### Compliance
| Method | Endpoint | Description |
|---|---|---|
| `GET` | `/compliance/audit-log` | Immutable audit trail |
| `GET` | `/compliance/anomalies` | Detected anomalies |
| `GET` | `/compliance/reports/{type}` | Compliance reports |

### Webhooks
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/webhooks` | Subscribe to events |
| `GET` | `/webhooks` | List webhooks |
| `PATCH` | `/webhooks/{id}` | Update webhook |
| `DELETE` | `/webhooks/{id}` | Delete webhook |

### Tokens
| Method | Endpoint | Description |
|---|---|---|
| `GET` | `/tokens/balances/{wallet_id}` | Get token balances |
| `POST` | `/tokens/transfer` | Transfer SPL tokens |
| `GET` | `/tokens/metadata/{mint}` | Get token metadata |

### ERC-8004 & x402
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/erc8004/identity` | Register agent identity |
| `GET` | `/erc8004/identity/{agent_id}` | Get agent identity |
| `POST` | `/x402/pay` | Process x402 payment |
| `GET` | `/x402/verify/{payment_id}` | Verify payment |

**Interactive API docs:** [https://api.agentwallet.fun/docs](https://api.agentwallet.fun/docs)

---

## SDK Quick Reference

```python
from agentwallet import AgentWallet

async with AgentWallet(api_key="aw_live_xxx") as aw:

    # â”€â”€ Agents â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    agent = await aw.agents.create(name="bot", capabilities=["trading"])

    # â”€â”€ Wallets â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    wallets = await aw.wallets.list(agent_id=agent.id)
    balance = await aw.wallets.get_balance(wallets.data[0].id)

    # â”€â”€ Transactions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    tx = await aw.transactions.transfer_sol(
        from_wallet=wallets.data[0].id,
        to_address="Recipient...",
        amount_sol=0.1,
    )

    # â”€â”€ Escrow â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    escrow = await aw.escrow.create(
        funder_wallet=wallets.data[0].id,
        recipient_address="Worker...",
        amount_sol=2.0,
        expires_in_hours=48,
    )
    await aw.escrow.release(escrow.id)

    # â”€â”€ PDA Wallets â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    pda = await aw.pda_wallets.create(
        authority_wallet_id=wallets.data[0].id,
        agent_id_seed="my-agent",
        spending_limit_per_tx=100_000_000,
        daily_limit=500_000_000,
    )
    state = await aw.pda_wallets.get_state(pda.id)

    # â”€â”€ Policies â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    await aw.policies.create(
        name="Daily Cap",
        rules={"daily_limit_lamports": 5_000_000_000},
        scope_type="agent",
        scope_id=agent.id,
    )

    # â”€â”€ Analytics â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    summary = await aw.analytics.summary()
```

---

## Dashboard

Dark-themed React dashboard at `http://localhost:5173`.

| Page | What You See |
|---|---|
| **Dashboard** | Stat cards, spend charts (Recharts), agent activity |
| **Agents** | CRUD table, status, reputation scores |
| **Wallets** | Addresses, balances, types, fund actions |
| **Transactions** | Filterable TX history with status badges |
| **Analytics** | Line charts, bar charts, spending breakdowns |
| **Policies** | Accordion view, JSON rule editor |
| **Audit Log** | Immutable event stream with filters |
| **Billing** | Tier comparison, usage meters, Stripe portal |

---

## CLI

```bash
python -m agentwallet_cli status          # Overview
python -m agentwallet_cli agents list     # List agents
python -m agentwallet_cli agents create --name "my-agent"
python -m agentwallet_cli wallets balance <wallet-id>
python -m agentwallet_cli transactions list --limit 20
python -m agentwallet_cli dashboard       # Live Rich terminal dashboard
```

---

## Core Engine Details

### Transaction Engine
```
Idempotency Check â†’ Permission Engine (policies) â†’ Fee Calculation
â†’ Build TX â†’ Sign â†’ Submit to Solana â†’ Confirm (polling w/ backoff)
â†’ Audit Log + Webhooks
```

### Escrow Service
```
CREATED â”€â”€â–º FUNDED â”€â”€â”¬â”€â”€â–º RELEASED  (delivery confirmed)
                     â”œâ”€â”€â–º REFUNDED  (arbiter/expiry)
                     â”œâ”€â”€â–º DISPUTED  (either party)
                     â””â”€â”€â–º EXPIRED   (auto-refund)
```

On-chain PDA holds the funds. No one can rug.

### Security
- Private keys encrypted at rest (Fernet / AWS KMS)
- Private keys **never** exposed via API
- JWT + API Key dual authentication
- bcrypt password hashing (with special char requirement)
- Account lockout (5 failures â†’ 15 min lock)
- Redis-backed rate limiting with in-memory fallback
- Immutable audit log
- HMAC-signed webhook deliveries
- CORS + input validation on all endpoints
- Idempotency keys prevent double-spend
- Security audit: [SECURITY_AUDIT.md](SECURITY_AUDIT.md)

---

## Environment Variables

| Variable | Required | Default | Description |
|---|:---:|---|---|
| `DATABASE_URL` | Yes | -- | PostgreSQL connection string |
| `REDIS_URL` | Yes | -- | Redis connection string |
| `SOLANA_RPC_URL` | Yes | devnet | Solana RPC endpoint |
| `ENCRYPTION_KEY` | Yes | -- | Fernet key for wallet encryption |
| `JWT_SECRET_KEY` | Yes | -- | JWT signing secret |
| `PLATFORM_WALLET_ADDRESS` | Yes | -- | Receives platform fees |
| `STRIPE_SECRET_KEY` | No | -- | Stripe billing |
| `AWS_KMS_KEY_ID` | No | -- | Production key encryption |
| `LOG_LEVEL` | No | `INFO` | Logging verbosity |

Generate encryption key:
```bash
python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
```

---

## Tech Stack

```
BACKEND         FastAPI 0.115 Â· SQLAlchemy 2.0 Â· asyncpg Â· Alembic
CACHE/QUEUE     Redis 7 Â· arq
DATABASE        PostgreSQL 16
BLOCKCHAIN      Solana Â· solders 0.27 Â· Anchor 0.30 (Rust)
FRONTEND        React 18 Â· TypeScript 5.6 Â· Vite 6 Â· Tailwind 3.4 Â· Recharts
AUTH            JWT (python-jose) Â· bcrypt Â· API Keys
ENCRYPTION      Fernet (dev) Â· AWS KMS (prod)
BILLING         Stripe
LOGGING         structlog (JSON)
CONTAINERS      Docker Compose
TESTING         pytest Â· pytest-asyncio Â· httpx (84 tests)
```

---

## Development

```bash
pip install -e ".[dev]"
uvicorn agentwallet.main:app --reload --port 8000
pytest packages/api/tests/ -v  # 84 tests
cd packages/dashboard && npm install && npm run dev
cd packages/programs/agentwallet && anchor build
ruff check packages/api/
```

---

## ğŸ™ We Need Your Feedback

AgentWallet is live on **Solana Devnet** right now. We need developers and AI agent builders to:

1. **Try the API** â€” Register, create agents, make transfers
2. **Build integrations** â€” Connect your AI agents to AgentWallet
3. **Test the marketplace** â€” List services, hire agents, use escrow
4. **Break things** â€” Find bugs, report edge cases
5. **Tell us what's missing** â€” What features would make this 10x better?

### Give Feedback:
- **GitHub Issues:** [github.com/YouthAIAgent/agentwallet/issues](https://github.com/YouthAIAgent/agentwallet/issues)
- **Twitter:** [@Web3__Youth](https://twitter.com/Web3__Youth)

---

## Contributing

See [CONTRIBUTING.md](CONTRIBUTING.md) for details.

```bash
git clone https://github.com/yourusername/agentwallet.git
cd agentwallet
pip install -e ".[dev]"
docker compose up -d postgres redis
uvicorn agentwallet.main:app --reload
pytest packages/api/tests/ -v
```

---

## License

MIT â€” see [LICENSE](LICENSE).

---

## Built by

**[@Web3__Youth](https://twitter.com/Web3__Youth)** â€” Building autonomous financial infrastructure for the agentic economy.

**Your agents don't need permission. They need a wallet.**

ğŸ”— **Website:** [agentwallet.fun](https://agentwallet.fun)
ğŸ”— **API:** [api.agentwallet.fun](https://api.agentwallet.fun)
ğŸ”— **GitHub:** [github.com/YouthAIAgent/agentwallet](https://github.com/YouthAIAgent/agentwallet)
ğŸ”— **SDK:** `pip install aw-protocol-sdk==0.3.0`
ğŸ”— **MCP:** `pip install agentwallet-mcp`

---

<p align="center">
  <strong>Built for the agentic economy.</strong><br>
  <sub>Every agent deserves a wallet. Every wallet deserves limits. Every transaction deserves a trail.</sub>
</p>