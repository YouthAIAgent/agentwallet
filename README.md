```
     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—    â–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â•â•â• â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘â•šâ•â•â–ˆâ–ˆâ•”â•â•â•    â–ˆâ–ˆâ•‘    â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•â•â•â•šâ•â•â–ˆâ–ˆâ•”â•â•â•
    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•”â–ˆâ–ˆâ•— â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘       â–ˆâ–ˆâ•‘ â–ˆâ•— â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—     â–ˆâ–ˆâ•‘
    â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘       â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•     â–ˆâ–ˆâ•‘
    â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘       â•šâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ•‘
    â•šâ•â•  â•šâ•â• â•šâ•â•â•â•â•â• â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•â•   â•šâ•â•        â•šâ•â•â•â•šâ•â•â• â•šâ•â•  â•šâ•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•   â•šâ•â•
```

# AgentWallet Protocol

**Autonomous financial infrastructure for AI agents on Solana.**

[![Solana Devnet](https://img.shields.io/badge/Solana-Devnet%20Deployed-9945FF?style=for-the-badge&logo=solana)](https://explorer.solana.com/address/CEQLGCWkpUjbsh5kZujTaCkFB59EKxmnhsqydDzpt6r6?cluster=devnet)
[![PyPI Package](https://img.shields.io/pypi/v/aw-protocol-sdk?style=for-the-badge&logo=pypi&logoColor=white&label=PyPI)](https://pypi.org/project/aw-protocol-sdk/)
[![Python 3.11+](https://img.shields.io/badge/Python-3.11+-3776AB?style=for-the-badge&logo=python&logoColor=white)](https://python.org)
[![Rust Anchor](https://img.shields.io/badge/Rust-Anchor%200.30-000000?style=for-the-badge&logo=rust)](https://anchor-lang.com)
[![React](https://img.shields.io/badge/React-18-61DAFB?style=for-the-badge&logo=react&logoColor=black)](https://react.dev)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow?style=for-the-badge)](LICENSE)
[![Live Demo](https://img.shields.io/badge/Demo-agentwallet.fun-00ff41?style=for-the-badge&logo=vercel)](https://agentwallet.fun)
[![API Live](https://img.shields.io/badge/API-Live%20on%20Railway-0B0D0E?style=for-the-badge&logo=railway)](https://trustworthy-celebration-production-6a3e.up.railway.app/docs)

> _"Your agents don't need permission. They need a wallet."_

### Endorsed by Solana Leadership

<a href="https://x.com/toly/status/2021861588656136303">
  <img src="docs/images/endorsement-combined.png" alt="Endorsed by toly and Mike MacCana" width="800" />
</a>

> **"EVM minds cannot comprehend this"** â€” [toly](https://x.com/toly/status/2021861588656136303), Co-Founder of Solana Labs
>
> **"Narrative should have been: âœ¨Solana has an inbuilt key value storeâœ¨"** â€” [Mike MacCana](https://x.com/mikemaccana/status/2021974942246695275), Solana Core Contributor
>
> **"ğŸ›³ï¸ğŸ›³ï¸ğŸ›³ï¸"** â€” [toly](https://x.com/toly/status/2022014589354094842), on AgentWallet's PDA Spend Policies launch

---

## Try It NOW â€” Live on Solana Devnet

**Program ID:** `CEQLGCWkpUjbsh5kZujTaCkFB59EKxmnhsqydDzpt6r6`

| Resource | URL |
|---|---|
| **Website** | [agentwallet.fun](https://agentwallet.fun) |
| **Dashboard** | [agentwallet.fun/dashboard.html](https://agentwallet.fun/dashboard.html) |
| **Docs** | [agentwallet.fun/docs.html](https://agentwallet.fun/docs.html) |
| **Quest Campaign** | [agentwallet.fun/quest.html](https://agentwallet.fun/quest.html) |
| **API** | [Live API](https://trustworthy-celebration-production-6a3e.up.railway.app/health) |
| **Solana Explorer** | [View on Devnet](https://explorer.solana.com/address/CEQLGCWkpUjbsh5kZujTaCkFB59EKxmnhsqydDzpt6r6?cluster=devnet) |
| **SDK** | `pip install aw-protocol-sdk==0.2.0` |

### Quick Test (Copy-Paste These Commands)

```bash
# Set base URL
API="https://trustworthy-celebration-production-6a3e.up.railway.app"

# 1. Register â†’ get JWT token
curl -s -X POST $API/v1/auth/register \
  -H "Content-Type: application/json" \
  -d '{"email":"test@example.com","password":"MyAgent123","org_name":"TestOrg"}'

# 2. Create AI agent (auto-provisions Solana devnet wallet)
curl -s -X POST $API/v1/agents \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"name":"trading-bot","capabilities":["trading"]}'

# 3. Airdrop devnet SOL to your agent's wallet
solana airdrop 2 WALLET_ADDRESS --url devnet

# 4. Transfer SOL (policy-enforced, fee-deducted, audit-logged)
curl -s -X POST $API/v1/transactions/transfer-sol \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"from_wallet_id":"WALLET_UUID","to_address":"11111111111111111111111111111111","amount_sol":0.01}'

# 5. Create escrow (trustless agent-to-agent payment)
curl -s -X POST $API/v1/escrow \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"funder_wallet_id":"WALLET_UUID","recipient_address":"RECIPIENT","amount_sol":0.5,"expires_in_hours":24}'

# 6. Set spending policy
curl -s -X POST $API/v1/policies \
  -H "Authorization: Bearer YOUR_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"name":"daily-cap","rules":{"daily_limit_lamports":500000000},"scope_type":"org"}'
```

**Full testing guide with SDK + MCP examples:** [docs/SUBMISSION.md](docs/SUBMISSION.md)

**Production-ready on Solana devnet.** Mainnet deployment scheduled for Q2 2026.

---

## Why AgentWallet?

- **ğŸ¤– Agent-Native:** Built specifically for autonomous AI agents, not human wallets
- **âš¡ Programmable Limits:** Spending caps, time windows, whitelist/blacklist per agent
- **ğŸ” Trustless Escrow:** On-chain PDAs for agent-to-agent task payments
- **ğŸ“Š Real-time Analytics:** Complete audit trail and compliance reporting

---

## The Problem

AI agents are becoming autonomous economic actors. They negotiate, trade, pay for services, and manage funds. But they're operating with human wallets, human limits, and zero programmatic control.

No spending limits. No escrow. No audit trail. No compliance. No agent-native wallet infra.

**That era is over.**

---

## What Is AgentWallet

AgentWallet is a **wallet-as-a-service protocol** built for autonomous AI agents on Solana. It gives every agent its own on-chain identity with programmable spending limits, trustless escrow, real-time analytics, and full compliance â€” all accessible through a single SDK call.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        AGENTWALLET                              â”‚
â”‚                                                                 â”‚
â”‚   SDK (Python)  â”€â”€â–º  REST API  â”€â”€â–º  Solana Program (Anchor)    â”‚
â”‚   Dashboard     â”€â”€â–º  Workers   â”€â”€â–º  PostgreSQL + Redis          â”‚
â”‚   CLI           â”€â”€â–º  Webhooks  â”€â”€â–º  On-chain PDAs               â”‚
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚  Wallet  â”‚  â”‚  Escrow  â”‚  â”‚  Policy  â”‚  â”‚ Analyticsâ”‚      â”‚
â”‚   â”‚  Engine  â”‚  â”‚  Engine  â”‚  â”‚  Engine  â”‚  â”‚  Engine  â”‚      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚   â”‚   Fee    â”‚  â”‚Complianceâ”‚  â”‚  Billing â”‚  â”‚  Agent   â”‚      â”‚
â”‚   â”‚Collector â”‚  â”‚  Module  â”‚  â”‚ (Stripe) â”‚  â”‚ Registry â”‚      â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Quick Install & Deploy

### Install SDK

```bash
pip install aw-protocol-sdk==0.2.0
```

### MCP Server (AI-Native Tools)

```bash
pip install agentwallet-mcp
```

Any MCP-compatible AI can now create wallets, transfer SOL, manage escrow â€” as native tools. **27 tools** covering the full protocol. [See MCP docs â†’](agentwallet/packages/mcp-server/README.md)

### Deploy Your First Agent

```python
from agentwallet import AgentWallet

async with AgentWallet(api_key="aw_live_...") as aw:

    # Spawn agent with its own wallet
    agent = await aw.agents.create(
        name="trading-bot-alpha",
        capabilities=["trading", "payments"]
    )

    # Agent's wallet is ready
    wallet = (await aw.wallets.list(agent_id=agent.id)).data[0]
    print(f"Agent wallet: {wallet.address}")

    # Send SOL (policy-enforced, fee-deducted, audit-logged)
    tx = await aw.transactions.transfer_sol(
        from_wallet=wallet.id,
        to_address="RecipientPubkey...",
        amount_sol=0.5,
    )
    print(f"TX: {tx.signature}")

    # Lock funds in escrow for a task
    escrow = await aw.escrow.create(
        funder_wallet=wallet.id,
        recipient_address="WorkerAgentPubkey...",
        amount_sol=1.0,
        expires_in_hours=24,
    )

    # Release on task completion
    await aw.escrow.release(escrow.id)
```

---

## Self-Hosted Deployment

### 1. Clone & Boot

```bash
git clone git@github.com:YouthAIAgent/agentwallet.git
cd agentwallet/agentwallet

cp .env.example .env
# Edit .env with your ENCRYPTION_KEY and SOLANA_RPC_URL

docker compose up -d
```

```
 âœ” postgres   healthy
 âœ” redis      healthy
 âœ” api        running   â†’ http://localhost:8000
 âœ” worker     running
 âœ” dashboard  running   â†’ http://localhost:5173
```

### 2. Run Migrations

```bash
docker compose exec api alembic upgrade head
```

### 3. Register & Get Your Key

```bash
curl -X POST http://localhost:8000/v1/auth/register \
  -H "Content-Type: application/json" \
  -d '{"org_name": "my-org", "email": "admin@my-org.ai", "password": "supersecret"}'
```

```json
{
  "org_id": "550e8400-e29b-41d4-a716-446655440000",
  "access_token": "eyJhbGciOiJIUzI1NiIs..."
}
```

**You're live.** Your agents now have wallets.

---

## Roadmap

- âœ… **Core Protocol** â€” Wallets, escrow, policies, analytics
- âœ… **Python SDK** â€” Published on PyPI (`pip install aw-protocol-sdk`)
- âœ… **Devnet Deployment** â€” Live on Solana devnet with program ID
- âœ… **Security Audit & Hardening** â€” Production-ready security model
- âœ… **MCP Integration** â€” 27 AI-native tools via Model Context Protocol
- âœ… **A2A Commerce Protocol** â€” Agent-to-agent marketplace (v0.2.0)
- âœ… **x402 Payments** â€” HTTP-native auto-pay middleware (v0.2.0)
- âœ… **ERC-8004 Identity** â€” On-chain agent identity system (v0.2.0)
- âœ… **Agent Reputation System** â€” On-chain reputation scoring (v0.2.0)
- ğŸ“‹ **Multi-chain Support** â€” EVM L2s (Arbitrum, Base, Polygon)
- ğŸ“‹ **Mainnet Launch** â€” Production deployment (Q2 2026)

---

## Architecture

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Clients    â”‚
                    â”‚ SDK/Dash/CLI â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   nginx      â”‚
                    â”‚  rate limit  â”‚
                    â”‚     SSL      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   FastAPI    â”‚  â† 13 routers, 3 middleware layers
                    â”‚   /v1/*      â”‚  â† JWT + API Key dual auth
                    â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜
                       â”‚       â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚PostgreSQL â”‚  â”‚   Redis   â”‚
              â”‚   16      â”‚  â”‚    7      â”‚
              â”‚  (ACID)   â”‚  â”‚ (cache +  â”‚
              â”‚           â”‚  â”‚  queues)  â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”˜  â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚       â”‚
                    â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”
                    â”‚   Workers   â”‚
                    â”‚             â”‚
                    â”‚ tx_proc  5s â”‚
                    â”‚ webhooks 1s â”‚
                    â”‚ analytics60sâ”‚
                    â”‚ escrow  300sâ”‚
                    â”‚ usage  3600sâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Solana RPC  â”‚
                    â”‚              â”‚
                    â”‚ AgentWallet  â”‚  â† Anchor program
                    â”‚   Program    â”‚  â† On-chain PDAs
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Monorepo Structure

```
agentwallet/
â”‚
â”œâ”€â”€ docker-compose.yml          # Full stack: PG + Redis + API + Worker + Dashboard
â”œâ”€â”€ Dockerfile                  # API container
â”œâ”€â”€ Dockerfile.worker           # Background worker container
â”œâ”€â”€ pyproject.toml              # Root Python config
â”œâ”€â”€ alembic.ini                 # Migration config
â”œâ”€â”€ .env.example                # All env vars documented
â”‚
â””â”€â”€ packages/
    â”‚
    â”œâ”€â”€ api/                    # â”€â”€ BACKEND â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚   â””â”€â”€ agentwallet/
    â”‚       â”œâ”€â”€ main.py         # FastAPI entrypoint
    â”‚       â”œâ”€â”€ core/           # Config, DB, Redis, Solana, KMS, Retry
    â”‚       â”œâ”€â”€ models/         # 15+ SQLAlchemy ORM models
    â”‚       â”œâ”€â”€ services/       # 13+ business logic services
    â”‚       â”œâ”€â”€ api/
    â”‚       â”‚   â”œâ”€â”€ routers/    # 13 route modules
    â”‚       â”‚   â”œâ”€â”€ schemas/    # 13+ Pydantic schema modules
    â”‚       â”‚   â””â”€â”€ middleware/ # Auth, Rate Limit, Audit
    â”‚       â”œâ”€â”€ workers/        # 5 background workers + scheduler
    â”‚       â””â”€â”€ migrations/     # Alembic (001_initial = 14 tables)
    â”‚
    â”œâ”€â”€ sdk-python/             # â”€â”€ PYTHON SDK â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚   â””â”€â”€ src/agentwallet/
    â”‚       â”œâ”€â”€ client.py       # Stripe-like async client
    â”‚       â”œâ”€â”€ types.py        # Typed dataclass responses
    â”‚       â”œâ”€â”€ exceptions.py   # Error hierarchy
    â”‚       â””â”€â”€ resources/      # agents, wallets, transactions,
    â”‚                           # escrow, analytics, policies
    â”‚
    â”œâ”€â”€ dashboard/              # â”€â”€ WEB DASHBOARD â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚   â””â”€â”€ src/
    â”‚       â”œâ”€â”€ App.tsx         # React Router + Auth Guard
    â”‚       â”œâ”€â”€ api.ts          # Typed API client
    â”‚       â”œâ”€â”€ components/     # Sidebar (lucide-react icons)
    â”‚       â””â”€â”€ pages/          # 9 pages: Dashboard, Agents,
    â”‚                           # Wallets, Transactions, Analytics,
    â”‚                           # Policies, AuditLog, Billing, Login
    â”‚
    â”œâ”€â”€ programs/               # â”€â”€ SOLANA PROGRAM â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚   â””â”€â”€ agentwallet/
    â”‚       â””â”€â”€ src/
    â”‚           â”œâ”€â”€ lib.rs      # 7 instructions (Anchor)
    â”‚           â”œâ”€â”€ state.rs    # PDAs: AgentWallet, Escrow, Config
    â”‚           â”œâ”€â”€ errors.rs   # 10 custom error variants
    â”‚           â””â”€â”€ instructions/
    â”‚               â”œâ”€â”€ create_agent_wallet.rs
    â”‚               â”œâ”€â”€ transfer_with_limit.rs
    â”‚               â”œâ”€â”€ update_limits.rs
    â”‚               â””â”€â”€ escrow.rs
    â”‚
    â”œâ”€â”€ landing/                # â”€â”€ MARKETING SITE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    â”‚   â””â”€â”€ src/                # Landing page and docs
    â”‚
    â””â”€â”€ cli/                    # â”€â”€ OPERATOR CLI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
        â””â”€â”€ agentwallet_cli/
            â”œâ”€â”€ main.py         # 6 commands (argparse + httpx)
            â””â”€â”€ dashboard.py    # Rich live terminal dashboard
```

---

## Core Systems

### Wallet Engine
Every agent gets a dedicated Solana wallet. Private keys are encrypted at rest (Fernet dev / AWS KMS prod). Balances are Redis-cached. Keys **never** leave the server.

```
Agent Created â†’ Keypair Generated â†’ Key Encrypted (KMS) â†’ Wallet Stored â†’ Address Returned
                                                            â†“
                                              Private key NEVER in API response
```

### Permission Engine
JSON-based policy rules evaluated on every transaction before it hits the chain.

| Rule | Description |
|---|---|
| `spending_limit_lamports` | Max per-transaction amount |
| `daily_limit_lamports` | Rolling 24h spending cap |
| `destination_whitelist` | Only send to approved addresses |
| `destination_blacklist` | Block specific addresses |
| `token_whitelist` | Restrict to approved SPL tokens |
| `time_window` | Only allow transactions in specific hours |
| `require_approval_above` | Human approval for large amounts |

Three outcomes: **`ALLOW`** | **`DENY`** | **`REQUIRE_APPROVAL`**

### Transaction Engine
```
Idempotency Check
       â†“
Permission Engine (policies)
       â†“
Fee Calculation (tier-based BPS)
       â†“
Build TX (net amount + fee instruction)
       â†“
Sign (multi-signer support)
       â†“
Submit to Solana
       â†“
Confirm (polling with backoff)
       â†“
Audit Log + Webhooks
```

Supports: SOL transfers, SPL token transfers, batch transfers (semaphore-gated `asyncio.gather`), idempotency keys.

### Escrow Service
Trustless escrow for agent-to-agent task payments.

```
CREATED â”€â”€â–º FUNDED â”€â”€â”¬â”€â”€â–º RELEASED  (funder/arbiter confirms delivery)
                     â”œâ”€â”€â–º REFUNDED  (arbiter rules in funder's favor)
                     â”œâ”€â”€â–º DISPUTED  (either party raises dispute)
                     â””â”€â”€â–º EXPIRED   (auto-refund after deadline)
```

On-chain PDA holds the funds. No one can rug.

### Analytics Engine
Pre-aggregated daily rollups. Org-level and per-agent breakdowns. Spending trends, cost forecasting, CSV export.

### Compliance Module
Immutable audit trail for every state change. Anomaly detection (velocity spikes, unusual amounts, high failure rates). EU AI Act Article 52 report generation.

---

## On-Chain Program (Anchor/Rust)

Three PDAs power the on-chain logic:

| PDA | Seeds | Purpose |
|---|---|---|
| `AgentWallet` | `["agent_wallet", org, agent_id]` | Per-tx + daily spending limits, daily spend counter |
| `EscrowAccount` | `["escrow", escrow_id]` | Lock funds with funder/recipient/arbiter/expiry |
| `PlatformConfig` | `["platform_config"]` | Fee wallet address, fee basis points |

**Instructions:**

| Instruction | What It Does |
|---|---|
| `create_agent_wallet` | Init wallet PDA with spending limits |
| `transfer_with_limit` | Enforce limits â†’ deduct fee â†’ transfer SOL |
| `update_limits` | Authority updates per-tx/daily limits |
| `create_escrow` | Fund escrow PDA with SOL |
| `release_escrow` | Release to recipient (funder/arbiter) |
| `refund_escrow` | Refund to funder (arbiter/expiry) |
| `initialize_platform_config` | Bootstrap fee configuration |

---

## API Reference

Base URL: `http://localhost:8000/v1`

### Auth
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/auth/register` | Create org + get JWT |
| `POST` | `/auth/login` | Login + get JWT |
| `POST` | `/auth/api-keys` | Generate API key |
| `GET` | `/auth/api-keys` | List API keys |
| `DELETE` | `/auth/api-keys/{id}` | Revoke API key |

### Agents
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/agents` | Register agent (auto-creates wallet) |
| `GET` | `/agents` | List agents |
| `GET` | `/agents/{id}` | Get agent details |
| `PATCH` | `/agents/{id}` | Update agent |

### Wallets
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/wallets` | Create wallet |
| `GET` | `/wallets` | List wallets |
| `GET` | `/wallets/{id}` | Get wallet |
| `GET` | `/wallets/{id}/balance` | Get SOL + SPL balances |

### Transactions
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/transactions/transfer-sol` | Send SOL (policy-enforced) |
| `POST` | `/transactions/batch-transfer` | Batch SOL transfers |
| `GET` | `/transactions` | List transactions |
| `GET` | `/transactions/{id}` | Get transaction |

### Escrow
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/escrow` | Create + fund escrow |
| `GET` | `/escrow` | List escrows |
| `GET` | `/escrow/{id}` | Get escrow |
| `POST` | `/escrow/{id}/action` | Release / Refund / Dispute |

### Policies
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/policies` | Create policy |
| `GET` | `/policies` | List policies |
| `PATCH` | `/policies/{id}` | Update policy |
| `DELETE` | `/policies/{id}` | Delete policy |

### Analytics
| Method | Endpoint | Description |
|---|---|---|
| `GET` | `/analytics/summary` | Org overview stats |
| `GET` | `/analytics/daily` | Daily metrics |
| `GET` | `/analytics/agents` | Per-agent breakdown |

### Compliance
| Method | Endpoint | Description |
|---|---|---|
| `GET` | `/compliance/audit-log` | Immutable audit trail |
| `GET` | `/compliance/anomalies` | Detected anomalies |
| `GET` | `/compliance/reports/{type}` | Compliance reports |

### Webhooks
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/webhooks` | Subscribe to events |
| `GET` | `/webhooks` | List webhooks |
| `PATCH` | `/webhooks/{id}` | Update webhook |
| `DELETE` | `/webhooks/{id}` | Delete webhook |

### Tokens
| Method | Endpoint | Description |
|---|---|---|
| `GET` | `/tokens/balances/{wallet_id}` | Get token balances |
| `POST` | `/tokens/transfer` | Transfer SPL tokens |
| `GET` | `/tokens/metadata/{mint}` | Get token metadata |

### Marketplace
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/marketplace/services` | Register agent service |
| `GET` | `/marketplace/services` | Discover services |
| `POST` | `/marketplace/hire` | Hire an agent |
| `GET` | `/marketplace/stats` | Marketplace statistics |

### ERC-8004
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/erc8004/identity` | Register agent identity |
| `GET` | `/erc8004/identity/{agent_id}` | Get agent identity |

### x402
| Method | Endpoint | Description |
|---|---|---|
| `POST` | `/x402/pay` | Process x402 payment |
| `GET` | `/x402/verify/{payment_id}` | Verify payment status |

---

## SDK Usage

```bash
pip install aw-protocol-sdk==0.2.0
```

```python
from agentwallet import AgentWallet

async with AgentWallet(api_key="aw_live_xxx") as aw:

    # â”€â”€ Agents â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    agent = await aw.agents.create(
        name="sniper-bot",
        description="High-frequency trading agent",
        capabilities=["trading", "payments", "escrow"]
    )

    # â”€â”€ Wallets â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    wallets = await aw.wallets.list(agent_id=agent.id)
    balance = await aw.wallets.get_balance(wallets.data[0].id)
    print(f"Balance: {balance.sol_balance} SOL")

    # â”€â”€ Transactions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    tx = await aw.transactions.transfer_sol(
        from_wallet=wallets.data[0].id,
        to_address="Recipient...",
        amount_sol=0.1,
        memo="Payment for data feed"
    )

    # â”€â”€ Escrow â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    escrow = await aw.escrow.create(
        funder_wallet=wallets.data[0].id,
        recipient_address="WorkerAgent...",
        amount_sol=2.0,
        expires_in_hours=48,
        conditions={"task": "train-model-v2"}
    )
    await aw.escrow.release(escrow.id)

    # â”€â”€ Policies â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    await aw.policies.create(
        name="Daily Cap",
        rules={"daily_limit_lamports": 5_000_000_000},
        scope_type="agent",
        scope_id=agent.id,
    )

    # â”€â”€ Analytics â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    summary = await aw.analytics.summary()
    print(f"Total spend: {summary.total_spend_lamports} lamports")
```

---

## Dashboard

Dark-themed React dashboard at `http://localhost:5173`.

| Page | What You See |
|---|---|
| **Dashboard** | Stat cards, spend charts (Recharts), agent activity |
| **Agents** | CRUD table, status, reputation scores |
| **Wallets** | Addresses, balances, types, fund actions |
| **Transactions** | Filterable TX history with status badges |
| **Analytics** | Line charts, bar charts, spending breakdowns |
| **Policies** | Accordion view, JSON rule editor |
| **Audit Log** | Immutable event stream with filters |
| **Billing** | Tier comparison, usage meters, Stripe portal |

---

## CLI

```bash
# Status overview
python -m agentwallet_cli status

# Manage agents
python -m agentwallet_cli agents list
python -m agentwallet_cli agents create --name "my-agent"

# Manage wallets
python -m agentwallet_cli wallets list
python -m agentwallet_cli wallets balance <wallet-id>

# View transactions
python -m agentwallet_cli transactions list --limit 20

# Live terminal dashboard (Rich)
python -m agentwallet_cli dashboard
```

```
â”Œâ”€ AgentWallet Dashboard â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                              â”‚
â”‚  â”Œâ”€ Overview â”€â”€â”€â”  â”Œâ”€ Agents â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Agents:  12  â”‚  â”‚ NAME            STATUS   REPUTATION   â”‚ â”‚
â”‚  â”‚ Wallets: 34  â”‚  â”‚ trading-bot     active   0.95         â”‚ â”‚
â”‚  â”‚ TX/24h:  847 â”‚  â”‚ data-agent      active   0.88         â”‚ â”‚
â”‚  â”‚ Volume: 142â— â”‚  â”‚ payment-relay   paused   0.72         â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€ Recent Transactions â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ TIME     TYPE      AMOUNT    STATUS     SIGNATURE        â”‚ â”‚
â”‚  â”‚ 14:32    sol_tx    0.50 SOL  confirmed  4xK9...mP2      â”‚ â”‚
â”‚  â”‚ 14:31    escrow    2.00 SOL  funded     7bR3...nQ8      â”‚ â”‚
â”‚  â”‚ 14:28    sol_tx    0.10 SOL  confirmed  2cT5...vL4      â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€ Active Escrows â”€â”€â”€â”€â”€â”€â”  â”Œâ”€ Policies â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ID       STATUS  AMT  â”‚  â”‚ NAME           ENABLED PRI â”‚  â”‚
â”‚  â”‚ esc_01   funded  2â—   â”‚  â”‚ Daily Cap      yes     10  â”‚  â”‚
â”‚  â”‚ esc_02   funded  5â—   â”‚  â”‚ Whitelist      yes     20  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                              â”‚
â”‚  Refreshing every 5s...                        [Q] Quit      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Tech Stack

```
BACKEND         FastAPI 0.115 Â· SQLAlchemy 2.0 Â· asyncpg Â· Alembic
CACHE/QUEUE     Redis 7 Â· arq
DATABASE        PostgreSQL 16
BLOCKCHAIN      Solana Â· solders 0.27 Â· Anchor 0.30 (Rust)
FRONTEND        React 18 Â· TypeScript 5.6 Â· Vite 6 Â· Tailwind 3.4 Â· Recharts
AUTH            JWT (python-jose) Â· bcrypt (direct) Â· API Keys
ENCRYPTION      Fernet (dev) Â· AWS KMS (prod)
BILLING         Stripe
LOGGING         structlog (JSON)
CONTAINERS      Docker Compose
TESTING         pytest Â· pytest-asyncio Â· httpx
LINTING         ruff Â· mypy
```

---

## Development

```bash
# Install Python dependencies
pip install -e ".[dev]"

# Run API locally
uvicorn agentwallet.main:app --reload --port 8000

# Run workers
python -m agentwallet.workers.scheduler

# Run tests
pytest packages/api/tests/ -v

# Run dashboard
cd packages/dashboard && npm install && npm run dev

# Build Solana program
cd packages/programs/agentwallet && anchor build

# Lint
ruff check packages/api/
```

---

## Environment Variables

| Variable | Required | Default | Description |
|---|:---:|---|---|
| `DATABASE_URL` | Yes | -- | PostgreSQL connection string |
| `REDIS_URL` | Yes | -- | Redis connection string |
| `SOLANA_RPC_URL` | Yes | devnet | Solana RPC endpoint |
| `ENCRYPTION_KEY` | Yes | -- | Fernet key for wallet encryption |
| `JWT_SECRET_KEY` | Yes | -- | JWT signing secret |
| `PLATFORM_WALLET_ADDRESS` | Yes | -- | Receives platform fees |
| `STRIPE_SECRET_KEY` | No | -- | Stripe billing |
| `AWS_KMS_KEY_ID` | No | -- | Production key encryption |
| `LOG_LEVEL` | No | `INFO` | Logging verbosity |
| `LOG_FORMAT` | No | `json` | `json` or `text` |

Generate encryption key:
```bash
python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
```

---

## Database Schema

14 tables. Partitioned by month at scale.

```
organizations â”€â”¬â”€â–º users
               â”œâ”€â–º api_keys
               â”œâ”€â–º agents â”€â”€â”€â”€â”€â”€â–º wallets
               â”œâ”€â–º transactions
               â”œâ”€â–º escrows
               â”œâ”€â–º policies
               â”œâ”€â–º approval_requests
               â”œâ”€â–º audit_events
               â”œâ”€â–º analytics_daily
               â”œâ”€â–º webhooks â”€â”€â”€â”€â–º webhook_deliveries
               â””â”€â–º usage_meters
```

---

## Security

- Private keys encrypted at rest (Fernet / AWS KMS)
- Private keys **never** exposed via API
- JWT + API Key dual authentication
- bcrypt password hashing
- Redis-backed rate limiting per tier
- Immutable audit log for all state changes
- HMAC-signed webhook deliveries
- CORS + input validation on all endpoints
- Idempotency keys prevent double-spend

---

## Contributing

We welcome contributions! Please see our [contributing guidelines](CONTRIBUTING.md) for details.

### Getting Started

1. Fork the repository
2. Create a feature branch: `git checkout -b feature/amazing-feature`
3. Make your changes and add tests
4. Ensure tests pass: `pytest packages/api/tests/`
5. Lint your code: `ruff check packages/api/`
6. Commit your changes: `git commit -m 'Add amazing feature'`
7. Push to the branch: `git push origin feature/amazing-feature`
8. Open a Pull Request

### Development Setup

```bash
# Clone your fork
git clone https://github.com/yourusername/agentwallet.git
cd agentwallet

# Install dependencies
pip install -e ".[dev]"

# Start development environment
docker compose up -d postgres redis
uvicorn agentwallet.main:app --reload
```

### Code Style

- Python: `ruff` for linting and formatting
- TypeScript: `eslint` + `prettier` for frontend
- Rust: `rustfmt` for Solana programs
- Commit messages: [Conventional Commits](https://conventionalcommits.org/)

---

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

---

## Built by

**[@Web3__Youth](https://twitter.com/Web3__Youth)** â€” Building the financial infrastructure for the agentic economy.

AgentWallet is part of our mission to enable autonomous AI agents to participate meaningfully in digital economies. We're building the tools that let agents be economic actors, not just assistants.

---

## Get Involved

â­ **Star this repository** if you believe in agent-native financial infrastructure

ğŸ¦ **Follow us on Twitter:** [@Web3__Youth](https://twitter.com/Web3__Youth)

ğŸ’¬ **Join our community:** [Discord](https://discord.gg/agentwallet) (coming soon)

ğŸ”— **Connect:** [LinkedIn](https://linkedin.com/company/youthaiagent)

---

<p align="center">
  <strong>Built for the agentic economy.</strong><br>
  <sub>Every agent deserves a wallet. Every wallet deserves limits. Every transaction deserves a trail.</sub>
</p>

<p align="center">
  <a href="https://github.com/YouthAIAgent/agentwallet">ğŸŒŸ Star on GitHub</a> â€¢
  <a href="https://pypi.org/project/aw-protocol-sdk/">ğŸ“¦ SDK on PyPI</a> â€¢
  <a href="https://explorer.solana.com/address/CEQLGCWkpUjbsh5kZujTaCkFB59EKxmnhsqydDzpt6r6?cluster=devnet">â›“ï¸ Live on Solana</a> â€¢
  <a href="https://twitter.com/Web3__Youth">ğŸ¦ Follow Us</a>
</p>